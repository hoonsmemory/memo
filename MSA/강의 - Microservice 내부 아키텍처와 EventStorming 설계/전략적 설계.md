## 전략적 설계
전략적 설계는 도메인 주도 설계(Domain-Driven Design, DDD)에서 시스템의 전반적인 구조와 경계를 정의하고,  
팀 간 협업과 비즈니스 요구사항을 효과적으로 반영하기 위해 사용되는 중요한 개념이다.  
이는 소프트웨어 개발 과정에서 도메인의 핵심 요소를 이해하고, 이를 기반으로 적절한 아키텍처와 팀 구조를 설계하는 데 중점을 둔다.  
<br>

### 핵심 개념
**하위 도메인(subdomain) 유형**  
<img width="620" alt="스크린샷 2024-11-25 오후 4 12 51" src="https://github.com/user-attachments/assets/bf07ec9e-c5c5-4472-8e51-c0d718a01ba9">  
1. Core Domain (핵심 도메인)
    * 비즈니스에서 가장 중요한 가치를 제공하는 도메인 영역이다.
    * Core Domain은 비즈니스의 성공을 결정짓는 핵심이므로, 가장 우선적으로 개발 리소스를 투입해야 한다.
    * 예) 우버의 방향에 따른 손님 매칭 서비스, 구글의 검색 순위 알고리즘
2. Supporting Domain (지원 도메인)
    * 핵심 도메인을 지원하기 위해 존재하는 부수적인 도메인이다.
    * 이를 통해 Core Domain이 자신의 역할에만 집중할 수 있도록 한다.
    * CRUD, ETL
3. Generic Domain (범용 도메인)
    * 모든 비즈니스에서 공통적으로 사용되는 도메인 영역이다.
    * 대부분 상용 라이브러리나 오픈소스로 대체 가능하다.
    * 예) 사용자 인증, 로그 관리
<br>
<br>

**바운디드 컨텍스트 관련**  
1. Bounded Context (경계 컨텍스트)
    * 도메인 모델이 적용되는 명확한 경계를 정의한 것으로, 각 컨텍스트는 독립적인 모델을 갖는다.(크기로 경계를 구분하지 않는다. )
    * 동일한 용어라도 컨텍스트에 따라 다른 의미를 가질 수 있기 때문에 이를 분리하여 혼란을 방지한다.
    * 바운디드 컨텍스트를 식별할 때는 경계를 넓게 해서 시작하자.(나중에 도메인 지식이 쌓이게 되면 좀 더 작은 경계로 쪼갠다.)
    * 예: "Order"가 주문 관리 컨텍스트에서는 상품 목록과 배송 정보일 수 있지만, 결제 컨텍스트에서는 결제 정보와 관련될 수 있다.
2. Context Mapping (컨텍스트 매핑)
    * 컨텍스트 매핑은 각 Bounded Context 간의 관계를 명확히 정의하고, 이를 기술적으로 해결하는 방법을 제공한다.
    * 시스템 내 여러 Bounded Context 간의 관계를 시각적으로 나타낸다.
    * 각 컨텍스트가 서로 데이터를 교환하거나 상호작용하는 방식을 정의하며, 팀 간의 협업 방식을 설정하는 데 도움을 준다.
    * 예: Upstream(상위 컨텍스트)과 Downstream(하위 컨텍스트)의 의존 관계, 반응 방식 등을 나타냄.
<br>

### Context Mapping에서 사용하는 주요 개념
<img width="935" alt="스크린샷 2024-11-25 오후 5 11 55" src="https://github.com/user-attachments/assets/a48fef10-39f6-4de7-9891-fdbdb624b546">  

**협력형 패턴 (Collaborative Patterns)**  
**2.1 Shared Kernel (공유 커널)**
* 두 컨텍스트가 공통된 모델의 일부를 공유하여 협력한다.
* 공통 부분은 매우 제한적으로 사용하며, 변경 시 양쪽 팀의 협업이 필요하다.
* 사용 사례: 팀 간 협력이 매우 긴밀하고, 공통된 모델이 중요한 경우.
* 예: 주문과 재고 관리 컨텍스트가 "상품 정보"를 공유.
<br>

**2.2 Customer-Supplier (고객-공급자 관계)**
* 하나의 컨텍스트가 다른 컨텍스트의 데이터를 사용한다.
* **Supplier(공급자)**는 데이터를 제공하고, **Customer(고객)**는 이를 소비한다.
* Customer가 Supplier에 요구사항을 전달할 수 있지만, 최종 결정은 Supplier가 내린다.
* 예: 주문 컨텍스트가 재고 컨텍스트에서 재고 정보를 가져올 때.
<br>

**2.3 Conformist (순응자)**
* 한 컨텍스트가 다른 컨텍스트의 모델을 그대로 수용한다.
* Conformist는 의존성을 피할 수 없거나, 두 컨텍스트 간의 상호작용을 단순하게 유지하고자 할 때 사용된다.
* 예: 결제 서비스가 외부 결제 게이트웨이의 데이터 모델을 그대로 사용하는 경우.
<br>
<br>

**분리형 패턴 (Segregated Patterns)**  
**2.4 Anti-Corruption Layer (ACL, 부패 방지 계층)**
* 서로 다른 모델 간의 변환을 담당하는 계층을 도입하여, 외부 모델이 내부 모델에 영향을 미치지 않도록 방지한다.
* 두 컨텍스트 간에 모델의 독립성을 유지하면서 통신할 수 있게 한다.
* 예: 배송 컨텍스트가 주문 컨텍스트의 데이터를 자체적으로 변환하여 사용.
<br>

**2.5 Open Host Service (OHS, 공개 호스트 서비스)**
* 한 컨텍스트가 공개 API나 서비스 계약을 통해 데이터를 제공한다.
* 여러 컨텍스트가 동일한 인터페이스를 통해 데이터를 소비할 수 있다.
* 예: 주문 컨텍스트가 REST API를 통해 주문 데이터를 제공.
<br>

**2.6 Published Language (공개 언어)**
* 두 컨텍스트가 공통의 언어(프로토콜, 메시지 포맷 등)를 사용하여 통신한다.
* 이벤트 메시지 또는 데이터 교환 표준을 정의해 서로의 모델 간 호환성을 높인다.
* 예: JSON 또는 Avro 포맷을 사용한 메시지 교환.
<br>
<br>

**독립형 패턴 (Independent Patterns)**
**2.7 Separate Ways (분리형 노선)**
* 두 컨텍스트가 완전히 독립적으로 동작하며 서로 통합하지 않는다.
* 데이터를 공유하지 않고, 중복을 허용해 각 컨텍스트의 독립성을 유지한다.
* 예: 주문 시스템과 배송 시스템이 각각 독립적으로 사용자 데이터를 별도로 관리.
<br>
<br>

### 이벤트 스토밍
<img width="948" alt="스크린샷 2024-11-25 오후 5 23 40" src="https://github.com/user-attachments/assets/c68179e2-b0cd-451f-9ec7-68716b9ef75d">  
이벤트 스토밍(Event Storming)은 도메인 주도 설계(DDD)에서 널리 사용되는 도메인 모델링 기법으로, 도메인 전문가와 개발자가 협력하여 비즈니스 프로세스를 시각적으로 표현하는 데 사용된다.   
이 방법은 시간 순서에 따라 중요한 이벤트를 정리하고, 참여자들이 도메인의 복잡성을 쉽게 이해할 수 있도록 돕는다.   
<br>
<br>
  
**이벤트 스토밍의 주요 구성 요소**  
<img width="1242" alt="스크린샷 2024-11-25 오후 5 23 56" src="https://github.com/user-attachments/assets/f36e4d43-10c1-4816-9a43-4358947430ee">  
이벤트 스토밍에서 사용하는 구성 요소들은 각각의 비즈니스 개념과 프로세스를 나타내는 시각적 도구로, 주로 색깔이 다른 포스트잇을 사용해 구분한다.  
<br>

**1. 도메인 이벤트 (Domain Event)**
* 설명: 시스템에서 발생한 중요한 비즈니스 이벤트.
* 역할: 도메인에서 "어떤 일이 발생했는지"를 나타냄. (과거형 동사로 표현)
* 예: 주문이 생성됨, 결제가 완료됨, 배송이 시작됨.
* 표현: 주황색 포스트잇.

**2. 핫스팟 (Hot Spot)**
* 설명: 논란, 불확실성, 복잡성이 높은 영역으로, 명확히 정의되지 않았거나 추가 논의가 필요한 부분.
* 역할: 도메인 전문가와 개발자가 집중적으로 논의해야 할 문제 영역을 식별하고, 도메인 설계에서 리스크를 관리.
* 예:
    * "결제가 실패했을 때 주문 상태를 어떻게 처리할 것인가?"
    * "할인 정책이 주문별로 다르게 적용되어야 하는데, 이를 어떻게 구현할 것인가?"
    * "외부 물류 시스템 API가 정확히 어떤 데이터를 반환하는지 불확실함."
* 표현: 보라색 포스트잇. (대각선으로 붙인다.)

**3. 커맨드 (Command)**
* 설명: 사용자가 시스템에 요청하거나, 시스템이 내부적으로 실행해야 하는 동작.
* 역할: "어떤 행동을 요청할 것인가"를 나타냄.
* 예: 회원가입, 주문 취소, 상품 등록.
* 표현: 파란색 포스트잇.

**4. 액터 (Actor)**
* 설명: 커맨드를 실행하거나 도메인 이벤트를 트리거하는 주체.
* 역할: 시스템에 영향을 주거나, 시스템의 동작에 의해 영향을 받는 역할.
* 예: 비회원, 고객, 운영자, 배송자. (명확하게 구분해야 한다.)
* 표현: 스티커나 특별한 아이콘.

**5. 정책 (Policy)**
* 설명: 특정 이벤트가 발생했을 때 실행되는 비즈니스 규칙이나 프로세스.
* 역할: "이 이벤트가 발생하면 어떤 행동을 해야 하는가"를 정의. (도메인 이벤트 -> 커맨드를 연결)
* 예: 결제가 완료되면 배송을 준비함.
* 표현: 연보라 포스트잇.

**6. 외부 시스템 (External System)**
* 설명: 시스템 외부에서 도메인과 상호작용하는 요소.
* 역할: 특정 이벤트나 커맨드를 트리거하거나, 데이터를 주고받는 역할.
* 예: 이메일 시스템, 결제 게이트웨이, 물류 API.
* 표현: 분홍색 포스트잇.

**7. 애그리거트 (Aggregate)**
* 설명: 시스템에서 관련 데이터와 비즈니스 로직을 그룹화한 엔티티.
* 역할: 이벤트와 커맨드의 중심에서 일관성을 유지하고, 트랜잭션 단위로 묶임.
* 예: 주문, 상품, 배송.
* 표현: 노란색 포스트잇.
<br>

**이벤트 스토밍 진행 단계**
1. 빅 픽처(Big Picture)
    * 비즈니스 전체를 아우르는 이벤트와 상호작용을 고수준에서 빠르게 식별.
    * 모든 팀원이 이해를 공유할 수 있는 출발점.
2. 프로세스 모델링(Process Modeling)
    * 도메인 이벤트와 커맨드 간의 구체적인 관계를 정의.
    * 정책, 액터, 외부 시스템 등을 추가하여 프로세스를 상세히 설계.
3. 디자인 레벨(Design Level)
    * 시스템 구현에 필요한 세부 설계 작업으로, 애그리게잇, 정책, 읽기 모델 등을 구체화.
<br>

**이벤트 스토밍의 장점**
* 시각적이고 협업 중심: 모든 팀원이 참여하여 비즈니스를 이해하고, 의견을 교환.
* 빠른 문제 발견: 비즈니스 프로세스에서의 장애물이나 불확실성을 빠르게 식별.
* 비즈니스와 기술 간의 갭 축소: 도메인 전문가와 개발자가 같은 언어로 문제를 논의.














































